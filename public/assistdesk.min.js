var scriptTag=document.getElementById("stealth-chatbot-widget"),chatbotId=Number(scriptTag.getAttribute("data-id")),userId=scriptTag.getAttribute("data-user"),chatbotHashId=scriptTag.getAttribute("data-bot"),chatbotName="";let chatIconName="lemuurchat.png";const cookieName="ASSISTDESK_CHATBOT",BASE_URL="https://api.assistdesk.in",ASSETS_URL="https://www.assistdesk.in";let messages=[],isTabletOrBelow=window.innerWidth<=820,quickReplies=[],primaryBgColor="#000000";function getDeviceType(){var e=navigator.userAgent;return/Mobi|Android/i.test(e)?"Mobile":/iPad|Tablet|PlayBook|Windows NT|Macintosh/i.test(e)?"Tablet":"Desktop"}function generateRandomId(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",o=0;o<8;o++){var n=Math.floor(Math.random()*e.length);t+=e.charAt(n)}return t}function getMessageContainerHeight(e,t){return e&&0===t.length?"calc(100vh - 200px)":e&&0<t.length?"calc(100vh - 220px)":e||0!==t.length?!e&&0<t.length?"340px":void 0:"360px"}function getCookie(e){for(var t=document.cookie.split(";"),o=0;o<t.length;o++){var n=t[o].trim();if(n.startsWith(e+"="))return n.substring(e.length+1)}return null}let messageContainer=document.createElement("div"),messageLoader=document.createElement("div"),chatWindow=document.createElement("div"),chatIconCustom=document.createElement("div"),chatIcon=document.createElement("img"),sendButton=document.createElement("button"),messageInput=document.createElement("input"),quickRepliesContainer=document.createElement("div"),sendContainerWrapper=document.createElement("div"),poweredByContainer=document.createElement("div"),assistDeskShadowDOM=document.createElement("div");document.body.appendChild(assistDeskShadowDOM);const shadow=assistDeskShadowDOM.attachShadow({mode:"open"}),styleElement=(chatWindow.onanimationend=e=>{"fade-out-to-bottom"===e.animationName&&(chatWindow.style.display="none")},document.createElement("style")),styleSheet=(shadow.appendChild(styleElement),styleElement.sheet),cssRule="* { box-sizing: border-box; margin: 0; padding: 0; font-family: inherit; }",fadeInFromBottomAnimation=(styleSheet.insertRule(cssRule,0),`
	@keyframes fade-in-from-bottom {
	  0% {
		opacity: 0;
		transform: translateY(10px);
	  }
	  100% {
		opacity: 1;
		transform: translateY(0);
	  }
	}
  `),pulsateAnimation=`
@keyframes pulsate {
	0% {
	  transform: scale(1);
	  opacity: 0.6;
	}
	50% {
	  transform: scale(1.2);
	  opacity: 1;
	}
	100% {
	  transform: scale(1);
	  opacity: 0.6;
	}`,fadeOutToBottomAnimation=`
  @keyframes fade-out-to-bottom {
    0% {
      opacity: 1;
      transform: translateY(0);
    }
    100% {
      opacity: 0;
	  visibility: hidden;
      transform: translateY(10px);
    }
  }
`,pulsateRingAnimation=`
@keyframes pulsate-ring {
	0% {
	  transform: scale(1);
	  opacity: 1;
	}
	50% {
	  transform: scale(1.5);
	  opacity: 0;
	}
	100% {
	  transform: scale(1);
	  opacity: 1;
	}
}`,style=document.createElement("style");function hideBottom(e,t,o){sendContainerWrapper.style.display=e,quickRepliesContainer.style.display=t,poweredByContainer.style.display=o}function displayMessage(e,t){var o=document.createElement("div"),t=(o.style.width="fit-content",o.style.padding="8px",o.style.whiteSpace="pre-line",o.style.marginTop="10px",o.style.maxWidth=isTabletOrBelow?"90%":"300px",o.style.fontSize=isTabletOrBelow?"20px":"15px","bot"===e?(o.style.backgroundColor="rgba(0,0,0, 0.05)",o.style.color="black",o.style.borderTopRightRadius="5px",o.style.boxShadow="0 0 2px rgba(0,0,0,0.3)"):(o.style.backgroundColor=primaryBgColor,o.style.boxShadow="0 0 5px rgba(0,0,0,0.3)",o.style.color="white",o.style.marginLeft="auto",o.style.borderTopLeftRadius="5px"),o.style.borderBottomRightRadius="5px",o.style.borderBottomLeftRadius="5px",t.replace(/\[(.*?)\]\((.*?)\)/g,(e,t,o)=>`<a style="text-decoration: underline; font-weight: bold;" href="${o}" target="_blank">${t}</a>`)),n=(o.classList.add("message"),document.createElement("p")),a=document.createElement("p");a.innerHTML=`<p style="white-space: pre-line;">${t.trim()}</p>`,n.textContent="bot"===e?"AI Assistant":"User",n.style.fontWeight="bold",n.style.marginBottom="5px",o.appendChild(n),o.append(a),messageContainer.appendChild(o),messageContainer.scrollTop=messageContainer.scrollHeight}function ticketRaiseUI(){const o=document.createElement("form");o.style.width="100%",o.style.height="100%",o.style.borderRadius="5px",o.style.padding="10px",o.style.marginBottom="2px",o.style.overflowY="auto",o.style.display="flex",o.style.flexDirection="column";var e=document.createElement("label");e.textContent="Your Email Id",e.style=`
		font-weight: bold;
		font-size: 13px;
	`,o.appendChild(e);const n=document.createElement("input");n.setAttribute("type","email"),n.setAttribute("required",!0),n.setAttribute("placeholder","Email"),n.style=`
		padding: 10px 5px;
		font-size: 16px;
		border-radius: 5px;
		border: rgba(0,0,0,0.05) solid 2px;
		margin-bottom: 10px;
	`,o.appendChild(n);e=document.createElement("label");e.textContent="Your enquiry",e.style=`
		font-weight: bold;
		font-size: 13px;
	`,o.appendChild(e);const a=document.createElement("textarea"),s=(a.setAttribute("placeholder","Your question / enquiry"),a.setAttribute("required",!0),a.style=`
		padding: 10px 5px;
		font-size: 16px;
		border-radius: 5px;
		border: rgba(0,0,0,0.05) solid 2px;
		width: 100%;
		height: 150px;
		margin-bottom: 10px;
	`,a.setAttribute("required",!0),o.appendChild(a),document.createElement("button"));s.innerHTML="Submit",s.style=`
	padding: 11px 20px;
	cursor: pointer;
		background-color: ${primaryBgColor};
		color: white;
		width: 100%;
		border-radius: 5px;
		border: solid 2px ${primaryBgColor};
		outline: none;
		font-size: 15px;
		margin-bottom: 5px;
	`,s.style.cursor="pointer",s.addEventListener("click",e=>{var t;e.preventDefault(),0<n.value.length&&0<a.value.length&&(i.style.display="none",s.textContent="Creating ticket for you..",e=n.value,t=a.value,e={name:chatbotName,chatbot_id:chatbotId,chatbot_hash:chatbotHashId,email:e,enquiry:t,user_id:userId},fetch(BASE_URL+"/api/v1/ticket/new",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>{if(!e.ok)throw"Please try again :(";s.textContent="Thank you! We've received your message!",setTimeout(()=>{o.remove(),hideBottom("block",messageContainer.style.display="flex","flex")},1500)}).catch(()=>{s.textContent="Please try again :(",setTimeout(()=>{s.innerHTML="Submit",n.value="",a.value="",i.style.display="block"},1e3)}))}),o.appendChild(s);var i=document.createElement("button");return i.innerHTML="Cancel",i.style=`
		padding: 11px 20px;
		cursor: pointer;
		color: black;
		font-size: 15px;
		width: 100%;
		border-radius: 5px;
		border: solid 2px ${primaryBgColor};
		outline: none;
	`,i.style.cursor="pointer",i.addEventListener("mouseover",function(){i.style.backgroundColor="rgba(0,0,0,0.05)"}),i.addEventListener("mouseout",function(){i.style.backgroundColor="white"}),i.addEventListener("click",()=>{o.remove(),hideBottom("block","flex","flex"),messageContainer.style.display="flex"}),o.appendChild(i),o}function app({position:e="bottomright",name:t="Customer Support",quickReplies:o=[]}){const n=document.createElement("div");n.style.width="100%",n.style.height=isTabletOrBelow?"70px":"50px",n.style.backgroundColor=primaryBgColor,n.style.color="white",isTabletOrBelow||(n.style.borderTopLeftRadius="5px",n.style.borderTopRightRadius="5px"),n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="space-between",n.style.padding="10px 20px 10px 20px";var a=document.createElement("div"),s=(a.style=`
		display: flex;
		align-items: center;
	`,document.createElement("p"));s.textContent=t,s.style.textTransform="capitalize",s.style.marginRight="10px",s.style.fontFamily="sans-serif",s.style.fontSize=isTabletOrBelow?"20px":"18px",s.style.fontWeight=800,a.appendChild(s);const i=document.createElement("button");i.textContent="Raise Ticket",i.style=`
		font-weight: bold;
		background-color: ${primaryBgColor};
		color: white;
		font-size: ${isTabletOrBelow?"18px":"15px"};
		border: white solid 2px;
		border-radius: 5px;
		cursor: pointer;
		padding: 3px 10px;
	`,i.addEventListener("mouseover",function(){i.style.backgroundColor="white",i.style.color="black"}),i.addEventListener("mouseout",function(){i.style.backgroundColor=primaryBgColor,i.style.color="white"}),i.addEventListener("click",function(){var e,t;"flex"===messageContainer.style.display&&(messageContainer.style.display="none",e=n.parentNode,t=ticketRaiseUI(),e.insertBefore(t,n.nextSibling),hideBottom("none","none","none"))}),a.appendChild(i),n.appendChild(a);t=document.createElement("div"),t.style=`
		display: flex;
		align-items: center;
		justify-content: center;
	`,t.addEventListener("click",()=>{chatWindow.style.animationName="fade-out-to-bottom",chatWindow.style.animationDuration="0.2s",chatIcon.src=ASSETS_URL+"/"+chatIconName,chatIcon.style.height="33px",chatIcon.style.width="36px"}),s=document.createElement("img"),s.src=ASSETS_URL+"/close.png",s.style=`
		height: 15px;
		cursor: pointer;
	`,t.appendChild(s),n.appendChild(t),a=document.createElement("div"),s=document.createElement("img");s.src=ASSETS_URL+"/close.png",s.style.height="10px",s.style.width="10px",s.style.cursor="pointer",s.addEventListener("click",()=>{r.style.animationName="fade-out-to-bottom",r.style.animationDuration="0.2s"}),a.append(s),s.style.float="right";const r=document.createElement("div");r.addEventListener("animationend",e=>{"fade-out-to-bottom"===e.animationName&&(r.style.display="none")}),r.append(a),r.style.boxShadow="0 0 3px rgba(0,0,0,0.5)",r.style.backgroundColor=""+primaryBgColor,r.style.color="white",r.style.fontWeight="bold",r.style.width="220px",r.style.borderRadius="10px","bottomright"===e?(r.style.right="40px",r.style.borderBottomRightRadius="0"):(r.style.left="40px",r.style.borderBottomLeftRadius="0"),r.style.bottom="85px",r.style.padding="8px",r.style.zIndex=9999999,r.style.position="fixed",r.style.animationName="fade-in-from-bottom",r.style.animationDuration="0.5s";t=document.createElement("p");t.textContent="Hey There! 👋 Im here to help you!",r.append(t),shadow.appendChild(r),chatIconCustom.id="chat-icon",chatIconCustom.style.height=isTabletOrBelow?"63px":"58px",chatIconCustom.style.width=isTabletOrBelow?"63px":"58px",chatIconCustom.style.borderRadius="50%",chatIconCustom.style.display="flex",chatIconCustom.style.alignItems="center",chatIconCustom.style.justifyContent="center",chatIconCustom.style.textContent="chat",chatIconCustom.style.border="white solid 1px",chatIconCustom.style.cursor="pointer",chatIconCustom.style.backgroundColor=primaryBgColor,chatIconCustom.style.border="white solid 2px","bottomright"===e?chatIconCustom.style.right="20px":chatIconCustom.style.left="20px",chatIconCustom.style.bottom="20px",chatIconCustom.style.zIndex=9999999,chatIconCustom.style.position="fixed",chatIconCustom.style.animationName="fade-in-from-bottom",chatIconCustom.style.animationDuration="0.2s",chatIcon.src=ASSETS_URL+"/"+chatIconName,chatIcon.style.height="33px",chatIcon.style.width="36px",chatIconCustom.appendChild(chatIcon),shadow.appendChild(chatIconCustom),chatWindow.id="chat-window",chatWindow.style.backgroundColor="white",isTabletOrBelow?(chatWindow.style.height="100%",chatWindow.style.width="100%",chatWindow.style.position="fixed",chatWindow.style.top="0",chatWindow.style.left="0",chatWindow.style.borderRadius="0px"):(chatWindow.style.border="solid 0.5px lightgray",chatWindow.style.boxShadow="0 0 5px lightgray",chatWindow.style.marginLeft="20px",chatWindow.style.height="500px",chatWindow.style.position="fixed",chatWindow.style.bottom="85px","bottomright"===e?chatWindow.style.right="10px":chatWindow.style.left="10px",chatWindow.style.borderRadius="5px",chatWindow.style.width="390px"),chatWindow.style.zIndex=99999999,chatWindow.style.display="none",shadow.appendChild(chatWindow),chatWindow.appendChild(n),messageContainer.className="message-container",messageContainer.style.width="100%",messageContainer.style.height=getMessageContainerHeight(isTabletOrBelow,o),messageContainer.style.padding="0 10px 0 10px",messageContainer.style.borderRadius="5px",messageContainer.style.overflowY="auto",messageContainer.style.display="flex",messageContainer.style.flexDirection="column",chatWindow.appendChild(messageContainer),quickRepliesContainer.style=`
		display: flex;
		gap: 5px;
		margin: ${isTabletOrBelow?"7px":"5px"}; 
		height: ${0<o.length} ? 30px : 0;
		width: 100%;
		overflow-x: auto;						
		align-items: center;
	`,o.forEach(t=>{const e=document.createElement("div");var o=document.createElement("p");o.textContent=t.keyword,o.style.marginRight="5px",o.style.marginLeft="5px",o.style.fontSize=isTabletOrBelow?"15px":"13px",e.appendChild(o),e.style=`
			cursor: pointer;
			white-space: nowrap;
			border: ${primaryBgColor} solid 2px;
			color: ${primaryBgColor};
			display: flex;
			align-items: center;
			justify-content: center;
			border-radius: 20px;
		`,e.addEventListener("mouseover",function(){e.style.opacity=.5}),e.addEventListener("mouseout",function(){e.style.opacity=1}),e.addEventListener("click",e=>{p(e,t.question)}),quickRepliesContainer.appendChild(e)}),chatWindow.appendChild(quickRepliesContainer),messageInput.type="text",messageInput.style.padding="5px",messageInput.style.borderTopLeftRadius="5px",messageInput.style.borderBottomLeftRadius="5px",messageInput.style.outline="none",messageInput.style.border="white solid 2px",messageInput.style.flex=1,messageInput.style.fontSize=isTabletOrBelow?"17px":"15px",messageInput.placeholder="Ask any question...",messageInput.addEventListener("focus",function(){messageInput.style.border=primaryBgColor+" solid 2px"}),messageInput.addEventListener("blur",function(){messageInput.style.border="white solid 2px"}),(messageLoader=document.createElement("div")).className="loader",messageLoader.style.backgroundColor="rgba(0,0,0, 0.1)",messageLoader.style.width="fit-content",messageLoader.style.padding="10px",messageLoader.style.borderTopRightRadius="5px",messageLoader.style.borderBottomRightRadius="5px",messageLoader.style.marginTop="10px",messageLoader.style.borderBottomLeftRadius="5px",messageLoader.style.display="flex",messageLoader.style.height="10px";for(let e=0;e<3;e++){var l=document.createElement("div"),d=`
		@keyframes bounce-animation-${e} {
		  0% {
			transform: translateY(0);
		  }
		  100% {
			transform: translateY(-5px);
		  }
		}
		`,c=document.createElement("style");c.appendChild(document.createTextNode(d)),shadow.appendChild(c),l.className="dot",l.style.width="10px",l.style.height="10px",l.style.marginRight="3px",l.style.backgroundColor="gray",l.style.borderRadius="50%",l.style.animationName="bounce-animation-"+e,l.style.animationDuration="0.3s",l.style.animationIterationCount="infinite",l.style.animationDirection="alternate",messageLoader.appendChild(l)}sendButton.textContent="Ask",sendButton.style.width="70px",sendButton.style.backgroundColor=primaryBgColor,sendButton.style.color="white",sendButton.style.borderTopRightRadius="5px",sendButton.style.borderBottomRightRadius="5px",sendButton.style.border="none",sendButton.style.cursor="pointer",sendButton.style.fontSize="13px",sendButton.addEventListener("click",e=>{0!==messageInput.value.trim().length&&p(e)}),sendContainerWrapper.style.height=isTabletOrBelow?"55px":"45px",sendContainerWrapper.style.padding="0 5px 0 5px";s=document.createElement("div"),s.appendChild(messageInput),s.appendChild(sendButton),s.style.border="lightgray solid 0.5px",s.style.boxShadow="0 0 3px rgba(0,0,0,0.1)",s.style.display="flex",s.style.height="100%",s.style.padding="1px",s.style.width="100%",s.style.borderRadius="5px",sendContainerWrapper.appendChild(s),chatWindow.appendChild(sendContainerWrapper),poweredByContainer.style.height="5%",poweredByContainer.style.display="flex",poweredByContainer.style.padding="2px",poweredByContainer.style.alignItems="center",poweredByContainer.style.justifyContent="center",a=document.createElement("p"),t=document.createElement("a");function p(e,o=""){if("Enter"===e.key||"click"===e.type){e=0===o.length?messageInput.value.trim():o;if(""!==e||0!==e.length){let t="";messages.length<=2?(t="",messages.slice(-2).forEach(e=>{t+=`
 ${e.origin}: `+e.message})):messages.length<=4&&(t="",messages.slice(-4).forEach(e=>{t+=`
 ${e.origin}: `+e.message})),messages.push({origin:"user",message:e}),displayMessage("user",e),messageInput.value="";var n,o=getCookie(cookieName);o||(o=generateRandomId(),(n=new Date).setDate(n.getDate()+2),o=cookieName+"="+o+"; expires="+n.toUTCString()+"; path=/",document.cookie=o),sendButton.disabled=!0,messageInput.disabled=!0,messageContainer.appendChild(messageLoader),messageContainer.scrollTop=messageContainer.scrollHeight,quickRepliesContainer.style.pointerEvents="none",fetch(BASE_URL+"/api/v1/chatbot/message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e,chatbot_id:chatbotId,user_id:userId,user_session_id:getCookie(cookieName),info:JSON.stringify({channel:getDeviceType()}),context:t,name:chatbotName,chatbot_hash:chatbotHashId})}).then(e=>e.json()).then(e=>{let t=e.message.reply;(t=(t=(t=t.includes("AI Assistant:")?t.replace("AI Assistant:",""):t).includes("bot:")?t.replace("bot:",""):t).includes("Assist Desk:")?t.replace("Assist Desk:",""):t).includes("Reply:")&&(t=t.replace("Reply:","")),messageContainer.removeChild(messageLoader),messages.push({origin:"AI Assistant",message:t}),displayMessage("bot",t)}).catch(e=>{messageContainer.removeChild(messageLoader),displayMessage("bot","Thank you for your question! I'm constantly learning and expanding my knowledge base. However, it seems like I don't have enough information to provide a specific answer at the moment. Could you please provide more details or ask another question? I'll do my best to assist you.")}).finally(()=>{sendButton.disabled=!1,quickRepliesContainer.style.pointerEvents="auto",messageInput.disabled=!1})}}}t.style.fontWeight=800,t.style.color=primaryBgColor,t.textContent="Assist Desk",t.href="https://www.assistdesk.in",t.target="_blank",t.style.textDecoration="underline",a.textContent="Powered By ",a.style.fontFamily="sans-serif",a.style.fontSize="12px",a.style.marginRight="5px",poweredByContainer.appendChild(a),poweredByContainer.appendChild(t),chatWindow.appendChild(poweredByContainer),chatIconCustom.addEventListener("click",function(){var e="none"===chatWindow.style.display?"block":"none";chatIcon.src="none"==e?ASSETS_URL+"/"+chatIconName:ASSETS_URL+"/close.png","none"!=e?(chatWindow.style.display="block",chatWindow.style.animationName="fade-in-from-bottom",chatWindow.style.animationDuration="0.2s",messageInput.focus(),chatIcon.style.height="20px",chatIcon.style.width="20px"):(chatWindow.style.animationName="fade-out-to-bottom",chatWindow.style.animationDuration="0.2s",chatIcon.style.height="33px",chatIcon.style.width="36px")}),messageInput.addEventListener("keypress",p),sendButton.addEventListener("click",p)}style.appendChild(document.createTextNode(fadeInFromBottomAnimation)),style.appendChild(document.createTextNode(fadeOutToBottomAnimation)),style.appendChild(document.createTextNode(pulsateAnimation)),style.appendChild(document.createTextNode(pulsateRingAnimation)),shadow.appendChild(style),document.addEventListener("DOMContentLoaded",()=>{fetch(BASE_URL+"/api/v1/chatbot/widgetstatus",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatbot_id:chatbotId,chatbot_hash:chatbotHashId,user_id:userId})}).then(e=>e.json()).then(e=>{let t=[],o="",n=!1,a="bottomright",s="Customer Support";try{if(t=e.message.domains,o=e.message.status,a=e.message.position,s=e.message.name,chatbotName=e.message.name,quickReplies=e.message.quickreplies,primaryBgColor=e.message.primaryBgColor,null==quickReplies[0].keyword&&(quickReplies=[]),t.forEach(e=>{var t=window.location.protocol+"//"+window.location.host;e.trim()==t.trim()&&(n=!0)}),!n)return void console.log("ASSIST DESK BOT FAILED TO LOAD BECAUSE OF WRONG WHITE LIST DOMAIN!")}catch{return void console.log("ASSIST DESK BOT FAILED TO LOAD")}var i;0<t.length&&n&&"active"==o&&(e=generateRandomId(),document.cookie.includes(cookieName)||((i=new Date).setDate(i.getDate()+2),e=cookieName+"="+e+"; expires="+i.toUTCString()+"; path=/",document.cookie=e),app({position:a,name:s,quickReplies:quickReplies}),displayMessage("bot","I am your AI support agent. I can help you with any questions or inquiries you might have."))}).catch(e=>{console.log("ASSIST DESK BOT FAILED TO LOAD, RELOAD",e)})});